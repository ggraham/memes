---
title: "Motif Comparison using TomTom"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Motif Comparison using TomTom}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(dremeR)
```

## database types
 - .meme file
 - universalmotif list
 - dreme_results
 - `list()` of all the above (named will use that name as db id)
```{r}
options(meme_db = system.file("inst/extdata/db/fly_factor_survey_id.meme", package = "dremeR"))
```
 
 
## Input types

To use TomTom on existing motifs, `runTomTom()` will accept any motifs in
`universalmotif` format. The `universalmotif` package provides several utilities
for importing data from various sources.
```{r, eval=F}
library(universalmotif)
example_motif <- create_motif("CCRAAAW")
runTomTom(example_motif)
```

 
`runTomTom()` can also take the output of `runDreme` as input. 
```{r, eval=F}
data("dreme_example")
runTomTom(dreme_example) 
```

## output data
 - `tomtom` column
 - `drop_best_match()` to remove the best_match columns
 - `tidyr::unnest(tomtom)` to expand list column
 - `nest_tomtom` to re-nest
 - `update_best_match()` adds best_match columns to data from `tomtom` ranks
 - `force_best_match()` to manually set best match motif for certain entries.
 
## Visualize data
 - `view_tomtom_matches()`

## Saving Data from TomTom Web Server
![saving TomTom XML results](save_tomtom.png)
